<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wisdom AI Studio | Multimodal AI Tool</title>
    <meta name="description" content="Free AI Studio: Generate Images, Text, and Audio powered by Pollinations.ai">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .tab-active { background-color: #4f46e5; color: white; border-color: #4f46e5; }
        .tab-inactive { background-color: white; color: #4b5563; border-color: #e5e7eb; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col items-center p-4 text-slate-800 font-sans">

    <div class="text-center mb-8 mt-4">
        <h1 class="text-4xl font-extrabold text-indigo-600 mb-2 tracking-tight">
            <i class="fa-solid fa-layer-group"></i> Wisdom AI Studio
        </h1>
        <p class="text-slate-500">The All-in-One AI Creative Suite (Powered by <a href="https://pollinations.ai" target="_blank" class="text-indigo-500 hover:underline">Pollinations.ai</a>)</p>
    </div>

    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-xl max-w-2xl w-full border border-slate-100">
        
        <div class="flex mb-6 space-x-2 bg-slate-100 p-1 rounded-xl">
            <button onclick="switchTab('image')" id="tab-image" class="flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-200 tab-active">
                <i class="fa-solid fa-image mr-2"></i> Image
            </button>
            <button onclick="switchTab('text')" id="tab-text" class="flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-200 tab-inactive">
                <i class="fa-solid fa-comment-dots mr-2"></i> Chat/Text
            </button>
            <button onclick="switchTab('audio')" id="tab-audio" class="flex-1 py-3 px-4 rounded-lg font-semibold transition-all duration-200 tab-inactive">
                <i class="fa-solid fa-headphones mr-2"></i> Voice
            </button>
        </div>

        <div class="space-y-4">
            <div>
                <label id="inputLabel" class="block text-sm font-bold text-slate-700 mb-2">Describe your image:</label>
                <textarea id="promptInput" rows="3"
                       placeholder="e.g., A futuristic city in Thailand, cyberpunk style, 4k" 
                       class="w-full border border-slate-300 p-4 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 transition shadow-sm resize-none text-base"></textarea>
            </div>

            <div id="voiceSelectDiv" class="hidden animate-fade-in">
                <label class="block text-sm font-bold text-slate-700 mb-2">Select Voice Personality:</label>
                <select id="voiceSelect" class="w-full border border-slate-300 p-3 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white cursor-pointer">
                    <option value="alloy">Alloy (Neutral & Balanced)</option>
                    <option value="echo">Echo (Male & Warm)</option>
                    <option value="fable">Fable (British Male)</option>
                    <option value="onyx">Onyx (Deep Male)</option>
                    <option value="nova">Nova (Female & Energetic)</option>
                    <option value="shimmer">Shimmer (Female & Clear)</option>
                </select>
            </div>

            <div class="flex items-center gap-3 bg-indigo-50 p-3 rounded-xl border border-indigo-100">
                <div class="bg-indigo-600 text-white w-8 h-8 flex items-center justify-center rounded-full text-xs">
                    <i class="fa-solid fa-shield-halved"></i>
                </div>
                <span class="text-sm font-semibold text-slate-600">Human Check:</span>
                <span id="mathQuestion" class="font-bold text-indigo-700 text-lg"></span>
                <span class="text-slate-500">=</span>
                <input type="number" id="mathAnswer" placeholder="?" 
                       class="w-20 border border-slate-300 p-2 rounded-lg text-center focus:outline-none focus:ring-2 focus:ring-indigo-500">
            </div>
            
            <button onclick="checkCaptchaAndGenerate()" 
                    class="w-full bg-indigo-600 text-white py-4 px-4 rounded-xl hover:bg-indigo-700 transition duration-200 font-bold shadow-lg shadow-indigo-200 flex justify-center items-center gap-2 group text-lg">
                <span>Generate Content</span>
                <i class="fa-solid fa-wand-magic-sparkles group-hover:rotate-12 transition-transform"></i>
            </button>
        </div>

        <div class="mt-8 bg-slate-50 rounded-xl border border-dashed border-slate-300 min-h-[250px] flex flex-col items-center justify-center p-6 relative overflow-hidden">
            
            <div id="loading" class="hidden flex flex-col items-center animate-pulse">
                <i class="fa-solid fa-circle-notch fa-spin text-4xl text-indigo-600 mb-4"></i>
                <span class="text-indigo-600 font-medium">AI is thinking... please wait.</span>
            </div>

            <div id="placeholderText" class="text-center text-slate-400">
                <i class="fa-regular fa-lightbulb text-4xl mb-2 opacity-50"></i>
                <p class="text-sm">Your generated content will appear here.</p>
            </div>

            <div id="imageContainer" class="hidden w-full fade-in text-center">
                 <img id="resultImage" class="w-full h-auto rounded-lg shadow-md mb-3" alt="AI Result">
                 <a id="downloadBtn" href="#" target="_blank" class="inline-block bg-slate-800 text-white px-4 py-2 rounded-lg text-sm hover:bg-black transition">
                    <i class="fa-solid fa-download mr-1"></i> Download Image
                 </a>
            </div>
            
            <div id="resultText" class="w-full text-left hidden fade-in prose prose-slate max-w-none bg-white p-4 rounded-lg border border-slate-200 shadow-sm"></div>

            <div id="audioContainer" class="hidden w-full fade-in text-center">
                <div class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm flex flex-col items-center">
                    <i class="fa-solid fa-wave-square text-indigo-500 text-3xl mb-3"></i>
                    <audio id="resultAudio" controls class="w-full"></audio>
                </div>
            </div>

        </div>
    </div>

    <footer class="mt-12 text-center text-slate-400 text-xs pb-6">
        <p class="mb-2">Disclaimer: This tool connects to public APIs. Content is generated by AI.</p>
        <p>Created by <a href="https://github.com/pongsakfms-commits" class="font-bold hover:text-indigo-500 transition">pongsakfms</a></p>
    </footer>

    <script>
        // --- 1. Mode Switching Logic ---
        let currentMode = 'image';

        function switchTab(mode) {
            currentMode = mode;
            
            // Hide all results
            document.getElementById('imageContainer').classList.add('hidden');
            document.getElementById('resultText').classList.add('hidden');
            document.getElementById('audioContainer').classList.add('hidden');
            document.getElementById('placeholderText').classList.remove('hidden');
            document.getElementById('loading').classList.add('hidden');
            
            // Update Tabs UI
            ['image', 'text', 'audio'].forEach(m => {
                const btn = document.getElementById(`tab-${m}`);
                if(m === mode) {
                    btn.classList.remove('tab-inactive');
                    btn.classList.add('tab-active');
                } else {
                    btn.classList.remove('tab-active');
                    btn.classList.add('tab-inactive');
                }
            });

            // Update Labels & Inputs based on mode
            const label = document.getElementById('inputLabel');
            const input = document.getElementById('promptInput');
            const voiceDiv = document.getElementById('voiceSelectDiv');

            if(mode === 'image') {
                label.innerText = "Describe your image:";
                input.placeholder = "e.g., A golden retriever astronaut on the moon, 4k, realistic";
                voiceDiv.classList.add('hidden');
            } else if (mode === 'text') {
                label.innerText = "Ask AI something / Generate Text:";
                input.placeholder = "e.g., Write a 3-paragraph article about SEO trends in 2025";
                voiceDiv.classList.add('hidden');
            } else if (mode === 'audio') {
                label.innerText = "Enter text to speak (English works best):";
                input.placeholder = "e.g., Hello! Welcome to Wisdom Firm. How can I help you today?";
                voiceDiv.classList.remove('hidden');
            }
        }

        // --- 2. CAPTCHA Logic ---
        let num1, num2, correctAnswer;

        function generateMathQuestion() {
            num1 = Math.floor(Math.random() * 10) + 1; 
            num2 = Math.floor(Math.random() * 10) + 1; 
            correctAnswer = num1 + num2;
            document.getElementById('mathQuestion').innerText = `${num1} + ${num2}`;
            document.getElementById('mathAnswer').value = ''; 
        }

        // --- 3. Main Generation Logic ---
        async function checkCaptchaAndGenerate() {
            const userAnswer = parseInt(document.getElementById('mathAnswer').value);
            const prompt = document.getElementById('promptInput').value.trim();

            if (!prompt) return alert('Please enter a description first!');

            if (isNaN(userAnswer) || userAnswer !== correctAnswer) {
                alert("ðŸš« Incorrect math answer. Please try again.");
                generateMathQuestion();
                return;
            }

            // UI Loading State
            const loading = document.getElementById('loading');
            const placeholder = document.getElementById('placeholderText');
            const imgContainer = document.getElementById('imageContainer');
            const imgRes = document.getElementById('resultImage');
            const dlBtn = document.getElementById('downloadBtn');
            const textRes = document.getElementById('resultText');
            const audioContainer = document.getElementById('audioContainer');
            const audioRes = document.getElementById('resultAudio');

            loading.classList.remove('hidden');
            placeholder.classList.add('hidden');
            imgContainer.classList.add('hidden');
            textRes.classList.add('hidden');
            audioContainer.classList.add('hidden');
            textRes.innerHTML = '';

            const encodedPrompt = encodeURIComponent(prompt);
            const seed = Math.floor(Math.random() * 999999);

            try {
                if (currentMode === 'image') {
                    const url = `https://image.pollinations.ai/prompt/${encodedPrompt}?width=1024&height=1024&seed=${seed}&nologo=true`;
                    imgRes.src = url;
                    imgRes.onload = () => {
                        loading.classList.add('hidden');
                        imgContainer.classList.remove('hidden');
                        dlBtn.href = url;
                        generateMathQuestion(); // Reset captcha for next turn
                    };
                    imgRes.onerror = () => throwError();
                } 
                
                else if (currentMode === 'text') {
                    const response = await fetch(`https://text.pollinations.ai/${encodedPrompt}?seed=${seed}&model=openai`);
                    if(!response.ok) throw new Error("API Error");
                    const text = await response.text();
                    
                    loading.classList.add('hidden');
                    textRes.classList.remove('hidden');
                    // Simple formatting: replace newlines with <br>
                    textRes.innerHTML = text.replace(/\n/g, '<br>');
                    generateMathQuestion();
                } 
                
                else if (currentMode === 'audio') {
                    const voice = document.getElementById('voiceSelect').value;
                    const url = `https://text.pollinations.ai/${encodedPrompt}?model=openai-audio&voice=${voice}`;
                    
                    audioRes.src = url;
                    audioRes.onloadeddata = () => {
                        loading.classList.add('hidden');
                        audioContainer.classList.remove('hidden');
                        audioRes.play();
                        generateMathQuestion();
                    };
                    audioRes.onerror = () => throwError();
                }

            } catch (error) {
                console.error(error);
                throwError();
            }
        }

        function throwError() {
            const loading = document.getElementById('loading');
            const placeholder = document.getElementById('placeholderText');
            loading.classList.add('hidden');
            placeholder.classList.remove('hidden');
            placeholder.innerHTML = '<span class="text-red-500 font-bold">Error generating content. Please try again.</span>';
            generateMathQuestion();
        }

        // Initialize
        window.onload = generateMathQuestion;

    </script>
</body>
</html>
